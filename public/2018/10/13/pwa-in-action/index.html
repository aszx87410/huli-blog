<!DOCTYPE html>
<html class="has-navbar-fixed-top">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
<title>PWA å¯¦æˆ°ç¶“é©—åˆ†äº« - Huli</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.css">




<meta name="description" content>





    <meta name="description" content="å‰è¨€ å‰äº›æ—¥å­åœ¨å¿™å…¬å¸çš„ç”¢å“æ”¹ç‰ˆï¼Œå¾åŸæœ¬çš„ PHP æ›æˆå¾Œç«¯ Go + å‰ç«¯ React SPAï¼Œåˆ†æˆæ¡Œé¢ç‰ˆè·Ÿæ‰‹æ©Ÿç‰ˆå…©å€‹ä¸åŒçš„ Projectï¼Œè€Œæ—¢ç„¶éƒ½æ”¹ç‰ˆäº†ï¼Œè‡ªç„¶è¦æŠŠæœ€æ–°æœ€æ½®çš„ PWA ä¹Ÿæ”¾åœ¨ç›®æ¨™è£¡é¢ï¼Œä¹‹å‰è€³è PWA å¾ˆä¹…ä½†å»æ²’æœ‰å¯¦ä½œéçš„æˆ‘ä¹Ÿæœ‰äº†æ©Ÿæœƒä¾†å˜—è©¦é€™å€‹æ±è¥¿ã€‚ å¦‚ä»Šç”¢å“å·²ç¶“æ”¹ç‰ˆå®Œç•¢ä¸”ä¸Šç·šäº†å…©ä¸‰å€‹æœˆï¼Œæ…¢æ…¢ç©©å®šä¸‹ä¾†ï¼Œåœ¨å„ªåŒ– PWA çš„éç¨‹ä¸­ä¹Ÿè®“æˆ‘æœ‰äº†ä¸€äº›å¿ƒå¾—å¯ä»¥è®“å¤§å®¶åˆ†äº«ã€‚ åœ¨èˆ‰ä¸€äº›å¯¦éš›æ¡ˆä¾‹">
<meta name="keywords" content="Front-end">
<meta property="og:type" content="article">
<meta property="og:title" content="PWA å¯¦æˆ°ç¶“é©—åˆ†äº«">
<meta property="og:url" content="https://blog.huli.tw/2018/10/13/pwa-in-action/index.html">
<meta property="og:site_name" content="Huli">
<meta property="og:description" content="å‰è¨€ å‰äº›æ—¥å­åœ¨å¿™å…¬å¸çš„ç”¢å“æ”¹ç‰ˆï¼Œå¾åŸæœ¬çš„ PHP æ›æˆå¾Œç«¯ Go + å‰ç«¯ React SPAï¼Œåˆ†æˆæ¡Œé¢ç‰ˆè·Ÿæ‰‹æ©Ÿç‰ˆå…©å€‹ä¸åŒçš„ Projectï¼Œè€Œæ—¢ç„¶éƒ½æ”¹ç‰ˆäº†ï¼Œè‡ªç„¶è¦æŠŠæœ€æ–°æœ€æ½®çš„ PWA ä¹Ÿæ”¾åœ¨ç›®æ¨™è£¡é¢ï¼Œä¹‹å‰è€³è PWA å¾ˆä¹…ä½†å»æ²’æœ‰å¯¦ä½œéçš„æˆ‘ä¹Ÿæœ‰äº†æ©Ÿæœƒä¾†å˜—è©¦é€™å€‹æ±è¥¿ã€‚ å¦‚ä»Šç”¢å“å·²ç¶“æ”¹ç‰ˆå®Œç•¢ä¸”ä¸Šç·šäº†å…©ä¸‰å€‹æœˆï¼Œæ…¢æ…¢ç©©å®šä¸‹ä¾†ï¼Œåœ¨å„ªåŒ– PWA çš„éç¨‹ä¸­ä¹Ÿè®“æˆ‘æœ‰äº†ä¸€äº›å¿ƒå¾—å¯ä»¥è®“å¤§å®¶åˆ†äº«ã€‚ åœ¨èˆ‰ä¸€äº›å¯¦éš›æ¡ˆä¾‹">
<meta property="og:locale" content="zh-tw">
<meta property="og:image" content="https://user-images.githubusercontent.com/2755720/49352007-d3c09e00-f6f0-11e8-8106-01335810b01a.png">
<meta property="og:updated_time" content="2019-09-25T11:49:18.291Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="PWA å¯¦æˆ°ç¶“é©—åˆ†äº«">
<meta name="twitter:description" content="å‰è¨€ å‰äº›æ—¥å­åœ¨å¿™å…¬å¸çš„ç”¢å“æ”¹ç‰ˆï¼Œå¾åŸæœ¬çš„ PHP æ›æˆå¾Œç«¯ Go + å‰ç«¯ React SPAï¼Œåˆ†æˆæ¡Œé¢ç‰ˆè·Ÿæ‰‹æ©Ÿç‰ˆå…©å€‹ä¸åŒçš„ Projectï¼Œè€Œæ—¢ç„¶éƒ½æ”¹ç‰ˆäº†ï¼Œè‡ªç„¶è¦æŠŠæœ€æ–°æœ€æ½®çš„ PWA ä¹Ÿæ”¾åœ¨ç›®æ¨™è£¡é¢ï¼Œä¹‹å‰è€³è PWA å¾ˆä¹…ä½†å»æ²’æœ‰å¯¦ä½œéçš„æˆ‘ä¹Ÿæœ‰äº†æ©Ÿæœƒä¾†å˜—è©¦é€™å€‹æ±è¥¿ã€‚ å¦‚ä»Šç”¢å“å·²ç¶“æ”¹ç‰ˆå®Œç•¢ä¸”ä¸Šç·šäº†å…©ä¸‰å€‹æœˆï¼Œæ…¢æ…¢ç©©å®šä¸‹ä¾†ï¼Œåœ¨å„ªåŒ– PWA çš„éç¨‹ä¸­ä¹Ÿè®“æˆ‘æœ‰äº†ä¸€äº›å¿ƒå¾—å¯ä»¥è®“å¤§å®¶åˆ†äº«ã€‚ åœ¨èˆ‰ä¸€äº›å¯¦éš›æ¡ˆä¾‹">
<meta name="twitter:image" content="https://user-images.githubusercontent.com/2755720/49352007-d3c09e00-f6f0-11e8-8106-01335810b01a.png">





<link rel="icon" href="/img/lidemy_logo.png">


<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ovo|Source+Code+Pro">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/css/justifiedGallery.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">

<link rel="stylesheet" href="/css/style.css">

<script defer src="//use.fontawesome.com/releases/v5.0.8/js/all.js"></script>


    
    
    
    
    
    
    
    
    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-49773306-3"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-49773306-3');
</script>


    


</head>
<body>
    
<nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation">
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-item navbar-logo" href="/">
                
                    
                    Huli
                    
                
            </a>
            <div class="navbar-burger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <div class="navbar-menu navbar-start">
            
            <a class="navbar-item " href="/archives">æ–‡ç« åˆ—è¡¨</a>
            
            <a class="navbar-item " href="/categories">åˆ†é¡</a>
            
            <a class="navbar-item " href="/recommend">æ¨è–¦é–±è®€</a>
            
            <a class="navbar-item " href="/about">é—œæ–¼æˆ‘</a>
            
        </div>
        
        <div class="navbar-menu navbar-end">
            
            <a class="navbar-item search" title="æœå°‹" href="javascript:;">
                <i class="fas fa-search"></i>
            </a>
            
            
            
            <a class="navbar-item" target="_blank" title="Medium" href="https://medium.com/@hulitw">
                
                <i class="fab fa-medium"></i>
                
            </a>
               
            <a class="navbar-item" target="_blank" title="Twitter" href="https://twitter.com/aszx87410">
                
                <i class="fab fa-twitter"></i>
                
            </a>
               
            <a class="navbar-item" target="_blank" title="Facebook" href="https://www.facebook.com/profile.php?id=100000221410594">
                
                <i class="fab fa-facebook"></i>
                
            </a>
               
            
        </div>
    </div>
</nav>

    <section class="section">
    <div class="container">
    <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            PWA å¯¦æˆ°ç¶“é©—åˆ†äº«
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            <time datetime="2018-10-13T20:10:00.000Z" itemprop="datePublished">2018å¹´10æœˆ13æ—¥(1 å¹´å‰)</time>
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="/categories/Front-end/">Front-end</a>
        </span>
        
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <h1><span id="å‰è¨€">å‰è¨€</span></h1>
<p>å‰äº›æ—¥å­åœ¨å¿™å…¬å¸çš„ç”¢å“æ”¹ç‰ˆï¼Œå¾åŸæœ¬çš„ PHP æ›æˆå¾Œç«¯ Go + å‰ç«¯ React SPAï¼Œåˆ†æˆæ¡Œé¢ç‰ˆè·Ÿæ‰‹æ©Ÿç‰ˆå…©å€‹ä¸åŒçš„ Projectï¼Œè€Œæ—¢ç„¶éƒ½æ”¹ç‰ˆäº†ï¼Œè‡ªç„¶è¦æŠŠæœ€æ–°æœ€æ½®çš„ PWA ä¹Ÿæ”¾åœ¨ç›®æ¨™è£¡é¢ï¼Œä¹‹å‰è€³è PWA å¾ˆä¹…ä½†å»æ²’æœ‰å¯¦ä½œéçš„æˆ‘ä¹Ÿæœ‰äº†æ©Ÿæœƒä¾†å˜—è©¦é€™å€‹æ±è¥¿ã€‚</p>
<p>å¦‚ä»Šç”¢å“å·²ç¶“æ”¹ç‰ˆå®Œç•¢ä¸”ä¸Šç·šäº†å…©ä¸‰å€‹æœˆï¼Œæ…¢æ…¢ç©©å®šä¸‹ä¾†ï¼Œåœ¨å„ªåŒ– PWA çš„éç¨‹ä¸­ä¹Ÿè®“æˆ‘æœ‰äº†ä¸€äº›å¿ƒå¾—å¯ä»¥è®“å¤§å®¶åˆ†äº«ã€‚</p>
<p>åœ¨èˆ‰ä¸€äº›å¯¦éš›æ¡ˆä¾‹ä¹‹å‰ï¼Œå…ˆè®“æˆ‘å€‘ä¾†è«‡è«‡åˆ°åº•æ€æ¨£æ‰ç®—æ˜¯ PWAã€‚</p>
<a id="more"></a>
<h1><span id="pwa-åˆ°åº•æ˜¯ä»€éº¼">PWA åˆ°åº•æ˜¯ä»€éº¼ï¼Ÿ</span></h1>
<p>å¾ Google å®˜æ–¹çš„æ–‡ä»¶ï¼š<a href="https://developers.google.com/web/fundamentals/codelabs/your-first-pwapp/?hl=zh-tw" target="_blank" rel="noopener">ä½ çš„é¦–å€‹ Progressive Web App</a> ä¸­å¯ä»¥çœ‹å‡º PWA çš„ä¸€äº›è©³ç´°å®šç¾©ï¼Œä½†æˆ‘ä¸å¤ªå–œæ­¡é€™ç¨®åˆ¶å¼çš„è¦å‰‡ï¼Œå°æˆ‘ä¾†èªªï¼ŒPWA å°±æ˜¯ä¸€å€‹å¾ˆåƒ Native App çš„ Web Appï¼Œè€Œå…¶ä¸­ç€è¦½å™¨çš„æ”¯æ´ä¹Ÿä½”äº†å¾ˆå¤§çš„ä¸€éƒ¨åˆ†ã€‚</p>
<p>åœ¨ä»¥å¾€å„˜ç®¡ä½ çš„ç¶²ç«™åšå¾—å†æ€éº¼åƒ Native Appï¼Œä½ é‚„æ˜¯æœ‰å…©å€‹é›£é—œæ²’è¾¦æ³•å…‹æœï¼šé›¢ç·šçš„æ™‚å€™å°± GG ä»¥åŠæ²’è¾¦æ³•å®‰è£åœ¨æ‰‹æ©Ÿä¸Šï¼Œæ‰€ä»¥ä¸ç®¡æ€éº¼çœ‹ï¼Œäººå®¶éƒ½çŸ¥é“ä½ å°±æ˜¯å€‹ Web Appï¼Œæ°¸é éƒ½ä¸æœƒé•·å¾—åƒ Nativeã€‚</p>
<p>å¯æ˜¯è‡ªå¾ç€è¦½å™¨é–‹å§‹æ”¯æ´ Service Worker ä»¥åŠ manifest ä¹‹å¾Œï¼Œä¸Šé¢é€™å…©é»å°±è¢«å…‹æœäº†ï¼å¾—ç›Šæ–¼ Service Workerï¼Œè®“ç¶²é é›¢ç·šçš„æ™‚å€™ä¹Ÿèƒ½å¤ é‹ä½œï¼Œå¯ä»¥è‡ªå·±å¯« code ä¾†æ±ºå®šè¦æ¸²æŸ“ä»€éº¼ç•«é¢ï¼›è€Œç€è¦½å™¨çš„ã€Œæ–°å¢åˆ°ä¸»ç•«é¢ã€çš„åŠŸèƒ½æ›´æ˜¯è®“å®‰è£ Web App æˆç‚ºå¯èƒ½ï¼Œé–‹ç™¼è€…ä¹Ÿå¯ä»¥ç”¨ manifest.json ä¾†è‡ªè¨‚ä¸€äº›å…§å®¹ï¼Œåƒæ˜¯å•Ÿå‹•ç•«é¢ä»¥åŠå®‰è£åœ¨ä¸»ç•«é¢ä¸Šçš„åç¨±ç­‰ç­‰ã€‚</p>
<p>å°æˆ‘ä¾†èªªï¼Œå¦‚æœä½ èƒ½å¤ åˆ©ç”¨ä¸Šé¢é€™å…©é …æŠ€è¡“ï¼Œè®“ä½ çš„ Web App æˆåŠŸå®‰è£åœ¨æ‰‹æ©Ÿä¸Šä¸¦ä¸”çœ‹èµ·ä¾†è·Ÿ Native App æ²’å…©æ¨£ï¼Œæˆ‘è¦ºå¾—å°±èƒ½ç¨±ä½œæ˜¯ PWAã€‚</p>
<p>æˆ‘åœ¨ä¹‹å‰çš„æ–‡ç« ï¼ˆ<a href="https://blog.techbridge.cc/2018/08/18/cors-issue/" target="_blank" rel="noopener">åŸä¾† CORS æ²’æœ‰æˆ‘æƒ³åƒä¸­çš„ç°¡å–®</a>ï¼‰å·²ç¶“æœ‰åˆ†äº«é PWA åœ¨æ‰‹æ©Ÿä¸Šé¢çš„æ¨£å­äº†ï¼Œé€™é‚Šå°±ä¸å†è´…è¿°ã€‚é‚„è¨˜å¾—æˆ‘ç¬¬ä¸€æ¬¡é«”é©—å®‰è£ PWA çš„æ™‚å€™ä¹Ÿè¢«åš‡åˆ°äº†ï¼Œå› ç‚ºçœ‹èµ·ä¾†å°±è·Ÿ Native App æ²’å…©æ¨£ï¼Œå¦‚æœçœŸçš„åšå¾—å¥½ï¼Œæ‡‰è©²æ˜¯å¾ˆé›£å€åˆ†å‡ºä¾†çš„ã€‚æ˜æ˜æ˜¯å€‹ç¶²é å¯æ˜¯çœ‹èµ·ä¾†å»è·Ÿ Native App ä¸€æ¨£ï¼Œé€™å°±æ˜¯ PWAã€‚</p>
<p>æ¥è‘—ä¾†ä»‹ç´¹å¹¾å€‹ PWA çš„é‡è¦å› ç´ ï¼Œä½ è¦åš PWA å°±ä¸€å®šè¦æœ‰ä¸‹é¢å¹¾å€‹æ±è¥¿ã€‚</p>
<h1><span id="manifestjson">manifest.json</span></h1>
<p>é¦–å…ˆå…ˆä¾†è«‡<code>manifest.json</code>ï¼Œæœ‰å¯«é Android çš„éƒ½çŸ¥é“æœ‰å€‹æ±è¥¿å«åš<code>AndroidManifest.xml</code>ï¼Œå…¶å¯¦å…©å€‹æœ¬è³ªä¸Šæ˜¯ä¸€æ¨£çš„æ±è¥¿ï¼Œå°±æ˜¯å»æè¿°é€™å€‹ App çš„ä¸€äº›ç‰¹æ€§ã€‚</p>
<p>æˆ‘å€‘å…ˆä¾†çœ‹çœ‹ Google å®˜æ–¹æ–‡ä»¶ï¼š<a href="https://developers.google.com/web/fundamentals/web-app-manifest/" target="_blank" rel="noopener">The Web App Manifest</a>è£¡é¢çµ¦çš„ç¯„ä¾‹ï¼š</p>
<p><figure class="highlight json hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="hljs-attr">"short_name"</span>: <span class="hljs-string">"Maps"</span>,</span><br><span class="line">  <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Google Maps"</span>,</span><br><span class="line">  <span class="hljs-attr">"icons"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="hljs-attr">"src"</span>: <span class="hljs-string">"/images/icons-192.png"</span>,</span><br><span class="line">      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"image/png"</span>,</span><br><span class="line">      <span class="hljs-attr">"sizes"</span>: <span class="hljs-string">"192x192"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="hljs-attr">"src"</span>: <span class="hljs-string">"/images/icons-512.png"</span>,</span><br><span class="line">      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"image/png"</span>,</span><br><span class="line">      <span class="hljs-attr">"sizes"</span>: <span class="hljs-string">"512x512"</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="hljs-attr">"start_url"</span>: <span class="hljs-string">"/maps/?source=pwa"</span>,</span><br><span class="line">  <span class="hljs-attr">"background_color"</span>: <span class="hljs-string">"#3367D6"</span>,</span><br><span class="line">  <span class="hljs-attr">"display"</span>: <span class="hljs-string">"standalone"</span>,</span><br><span class="line">  <span class="hljs-attr">"scope"</span>: <span class="hljs-string">"/maps/"</span>,</span><br><span class="line">  <span class="hljs-attr">"theme_color"</span>: <span class="hljs-string">"#3367D6"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>è£¡é¢çµ¦çš„è³‡è¨Šå¾ˆç°¡å–®ï¼Œç„¶å¾Œæœƒè·Ÿä½ æŠŠ PWA æ–°å¢åˆ°ä¸»ç•«é¢æ™‚å‡ºç¾çš„æ±è¥¿æ¯æ¯ç›¸é—œã€‚<code>name</code>çš„è©±å°±æ˜¯ä½  App çš„åç¨±ï¼Œä»–åœ¨ä¸»ç•«é¢ä¸Šé¢å°±æœƒé¡¯ç¤ºé€™å€‹<code>name</code>ï¼Œä½†å¦‚æœä½ ä¹Ÿæœ‰æä¾›<code>short_name</code>çš„è©±æœƒå„ªå…ˆä½¿ç”¨<code>short_name</code>ã€‚</p>
<p>å†ä¾†<code>icons</code>å°±æ˜¯ä¸»ç•«é¢ä¸Šé¢æœƒå‡ºç¾çš„ logo å›‰ï¼Œé€™æ²’ä»€éº¼å¥½å¤šè«‡çš„ã€‚<code>start_url</code>å‰‡æ˜¯ä½ å¾ä¸»ç•«é¢ä¸Šé–‹å•Ÿæ™‚æœƒé€£ç·šåˆ°çš„åœ°æ–¹ï¼Œå¾ˆå¤šäººæœƒåŠ å€‹<code>?source=pwa</code>ä¹‹é¡çš„ï¼Œé€™æ¨£å°±å¯ä»¥çŸ¥é“é€™å€‹ä½¿ç”¨è€…æ˜¯ä½¿ç”¨ PWAï¼Œæ–¹ä¾¿åšä¸€äº›çµ±è¨ˆã€‚</p>
<p>é€™é‚Šæœ‰å€‹å°åœ°æ–¹è¦æ³¨æ„ï¼Œé‚£å°±æ˜¯åœ¨æŸä¸€ç‰ˆçš„ iOS Safariï¼ˆæŠ±æ­‰æˆ‘å¿˜è¨˜æ˜¯å“ªä¸€ç‰ˆï¼Œä½†ç¸½ä¹‹æœ€æ–°çš„å·²ç¶“æ²’æœ‰é€™å€‹å•é¡Œäº†ï¼‰ï¼Œå®ƒæ˜¯ä¸æœƒéµå®ˆ<code>start_url</code>çš„ï¼ä»–æœƒæ ¹æ“šçš„æ˜¯ä½ åœ¨å®‰è£ PWA æ™‚çš„ç¶²å€ï¼Œä¾‹å¦‚èªªä½ åœ¨<code>https://example.com/test/123</code>çš„æ™‚å€™æŒ‰ä¸‹ã€Œæ–°å¢åˆ°ä¸»ç•«é¢ã€ï¼Œä½ åœ¨ä¸»ç•«é¢é–‹å•Ÿ PWA æ™‚å°±æœƒé€£ç·šåˆ°é€™å€‹ç•«é¢ã€‚</p>
<p>é€™éƒ¨åˆ†å…¶å¯¦æ»¿å›°æ“¾çš„ï¼Œä½†å¹¸å¥½æœ€æ–°çš„ iOS Safari å·²ç¶“æ²’æœ‰é€™å€‹å•é¡Œäº†ï¼Œå¤§å®¶å¯ä»¥ä¸ç”¨æ“”å¿ƒã€‚</p>
<p>é‚„æœ‰ä¸€å€‹è¦ç‰¹åˆ¥æçš„å°±æ˜¯<code>name</code>ã€<code>background_color</code>è·Ÿ<code>icon</code>æœƒè‡ªå‹•çµ„æˆ<code>Splash screens</code>ï¼Œå°±æ˜¯ä½ åœ¨æ‰“é–‹ PWA çš„æ™‚å€™æœƒçœ‹åˆ°çš„ä¸€å€‹ç•«é¢ï¼Œæ˜¯ç”±é€™ä¸‰å€‹è³‡è¨Šè‡ªå‹•è¢« Chrome æ‰€çµ„æˆçš„ï¼Œæ„æ€å°±æ˜¯ä½ æ²’è¾¦æ³•å®¢è£½åŒ–é€™å€‹å•Ÿå‹•ç•«é¢ã€‚</p>
<p>å®ƒå°±æ˜¯æœƒé¡¯ç¤ºä½ æŒ‡å®šçš„èƒŒæ™¯é¡è‰²ã€ç„¶å¾Œä¸­é–“æ”¾ä¸€å€‹ icon ä¸‹é¢æ”¾ä½  App çš„åç¨±ï¼Œæ²’æœ‰å…¶ä»–æ±è¥¿å¯ä»¥èª¿äº†ï¼Œè‡³å°‘ç¾åœ¨æ˜¯é€™æ¨£ã€‚</p>
<p>åœ¨é€™é»ä¸Šé¢ iOS å°±ä¸ä¸€æ¨£ï¼ŒiOS æ˜¯ä¸æ”¯æ´é€™ç¨®å•Ÿå‹•ç•«é¢çš„ï¼Œä½†å¥½è™•å°±æ˜¯ä½ å¯ä»¥è‡ªå·±é€é html çš„ tag ä¾†è¨­å®šï¼</p>
<p><figure class="highlight html hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">link</span></span></span><br><span class="line"><span class="hljs-tag">    <span class="hljs-attr">rel</span>=<span class="hljs-string">'apple-touch-startup-image'</span></span></span><br><span class="line"><span class="hljs-tag">    <span class="hljs-attr">href</span>=<span class="hljs-string">'/assets/splash/splash-1125x2436.png'</span></span></span><br><span class="line"><span class="hljs-tag">    <span class="hljs-attr">media</span>=<span class="hljs-string">'(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)'</span></span></span><br><span class="line"><span class="hljs-tag">/&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>æœƒæœ‰ä¸€äº›å°ºå¯¸ç›¸é—œçš„è¨­å®šä½ å› ç‚ºè¦å¹«æ¯ä¸€ç¨®ä¸åŒçš„ device éƒ½æº–å‚™ä¸€å¼µåœ–ç‰‡ï¼Œè©³æƒ…å¯åƒè€ƒï¼š<a href="https://medium.com/@applification/progressive-web-app-splash-screens-80340b45d210" target="_blank" rel="noopener">Progressive Web App Splash Screens</a> æˆ–æ˜¯ <a href="https://www.netguru.co/codestories/few-tips-that-will-make-your-pwa-on-ios-feel-like-native" target="_blank" rel="noopener">Few Tips That Will Make Your PWA on iOS Feel Like Native</a>ã€‚</p>
<p>iOS è·Ÿ Android çš„å·®åˆ¥åœ¨æ–¼ iOS çš„å•Ÿå‹•ç•«é¢ä½ å¯ä»¥æ”¾ä¸€å¼µåœ–ç‰‡ï¼Œå› æ­¤å¯ä»¥å®Œå…¨å®¢è£½åŒ–ï¼Œä½ æƒ³æ”¾ä»€éº¼å°±æ”¾ä»€éº¼ï¼Œè‡ªç”±åº¦æ¯” Android ä¾†å¾—é«˜ã€‚</p>
<p>é‚„æœ‰å°±æ˜¯ icon çš„éƒ¨åˆ†ï¼ŒiOS ä¹Ÿä¸æœƒçœ‹ä½ <code>mainfest.json</code>çš„è¨­å®šï¼Œè€Œæ˜¯æœƒçœ‹è‡ªå·±çš„ html tagï¼Œæ‰€ä»¥ä½ å¿…é ˆé¡å¤–è¨­ç½®çµ¦ iOS ä½¿ç”¨çš„ iconï¼š</p>
<p><figure class="highlight html hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">link</span></span></span><br><span class="line"><span class="hljs-tag">    <span class="hljs-attr">rel</span>=<span class="hljs-string">'apple-touch-icon'</span></span></span><br><span class="line"><span class="hljs-tag">    <span class="hljs-attr">sizes</span>=<span class="hljs-string">'192x192'</span></span></span><br><span class="line"><span class="hljs-tag">    <span class="hljs-attr">href</span>=<span class="hljs-string">'/assets/favicons/iOS192x192.png'</span></span></span><br><span class="line"><span class="hljs-tag">/&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>å°æ–¼<code>manifest.json</code>ï¼Œè©²æ³¨æ„çš„é»å·®ä¸å¤šå°±é€™äº›ã€‚å…¶å¯¦æœ€å¤§çš„å•é¡Œé‚„æ˜¯æ”¯æ´åº¦ï¼Œæ‰€ä»¥ Google å‡ºäº†ä¸€å€‹<code>PWACompat</code>ï¼Œå¯ä»¥è‡ªå‹•å¹«ä½ é‡å°èˆŠçš„ç€è¦½å™¨èª¿æ•´ä½ çš„æª”æ¡ˆä»¥åŠ html çš„ tagï¼Œä¸éä¹Ÿæœ‰äººå¯«äº†ä¸€ç¯‡ï¼š<a href="https://medium.com/@firt/you-shouldnt-use-chrome-s-pwacompat-library-in-your-progressive-web-apps-6b3496faab62" target="_blank" rel="noopener">You shouldnâ€™t use Chromeâ€™s PWACompat library in your Progressive Web Apps</a> ä¾†å‘Šè¨´å¤§å®¶ä¸è¦ç”¨ï¼Œè«–é»å¤§æ¦‚æ˜¯ä¸èƒ½é€™æ¨£ä¸€æ¦‚è«–ä¹‹ï¼Œä½ å¿…é ˆé‡å°æ¯ç¨®ä¸åŒçš„å¹³å°è·Ÿç€è¦½å™¨å»äº†è§£ä»–çš„å·®ç•°å†ä¾†åšé©é…ï¼Œæ‰èƒ½å¾—åˆ°æœ€å¥½çš„ä½¿ç”¨è€…é«”é©—ï¼Œé€™ç¨®çµ±ä¸€èª¿æ•´çš„åšæ³•æœƒåœ¨å¾ˆå¤šåœ°æ–¹çœ‹èµ·ä¾† ok ä½†æ˜¯æ€ªæ€ªçš„ã€‚</p>
<p>æ—¢ç„¶ä¸Šé¢éƒ½æåˆ° iOS äº†ï¼Œå°±ä¾†è¬›è¬› iOS çš„ä¸€äº›ä¸åŒä¹‹è™•ã€‚å…¶å¯¦ iOS é–‹å§‹æä¾› PWA çš„æ”¯æ´æ˜¯ä»Šå¹´ï¼ˆ2018 å¹´ï¼‰çš„äº‹æƒ…è€Œå·²ï¼Œè€Œä¸”å‰›æ¨å‡ºçš„æ™‚å€™æ”¯æ´åº¦æ»¿å·®çš„ï¼Œä¸éæœ‰åœ¨æ…¢æ…¢æ”¹å–„å°±æ˜¯äº†ã€‚</p>
<p>é—œæ–¼é‚£äº› iOS ä¸åŒçš„åœ°æ–¹ï¼Œé€™å…©ç¯‡æ–‡ç« éƒ½è¬›å¾—å¾ˆæ¸…æ¥šäº†ï¼š<a href="https://medium.com/@firt/pwas-are-coming-to-ios-11-3-cupertino-we-have-a-problem-2ff49fd7d6ea" target="_blank" rel="noopener">PWAs are coming to iOS 11.3: Cupertino, we have a problem</a>ã€<a href="https://medium.com/@firt/progressive-web-apps-on-ios-are-here-d00430dee3a7" target="_blank" rel="noopener">Progressive Web Apps on iOS are here ğŸš€</a>ã€‚</p>
<p>æœ€å¤§çš„å·®ç•°ä¹‹ä¸€å¤§æ¦‚å°±æ˜¯å¾ˆå¤šæ™‚å€™éƒ½ä¸çœ‹<code>manifest.json</code>ï¼Œä½ è¦è‡ªå·±é¡å¤–è¨­ç½®ä¸€äº›ç›¸å°æ‡‰çš„ html tag æ‰æœ‰ç”¨ï¼Œé€™é»æ˜¯è¦ç‰¹åˆ¥æ³¨æ„çš„ã€‚</p>
<p>å†ä¾†å°±æ˜¯<code>&lt;meta name=â€apple-mobile-web-app-capableâ€ content=â€yesâ€&gt;</code>é€™å€‹ tag ä¹Ÿå¾ˆé‡è¦ï¼Œä¸»è¦æ˜¯å‘Šè¨´ç€è¦½å™¨èª¬ï¼šã€Œæˆ‘æº–å‚™å¥½æä¾›å…¨è¢å¹•çš„é«”é©—äº†ï¼Œå°±ç®—éš±è—ç€è¦½å™¨çš„ UI ä¹Ÿæ²’é—œä¿‚ã€ï¼Œè€Œé€™ç¯‡ï¼š<a href="https://medium.com/@firt/dont-use-ios-web-app-meta-tag-irresponsibly-in-your-progressive-web-apps-85d70f4438cb" target="_blank" rel="noopener">Donâ€™t use iOS meta tags irresponsibly in your Progressive Web Apps</a> å‰‡å‘Šè¨´ä½ åƒè¬ä¸è¦æ¿«ç”¨é€™å€‹ tagï¼Œä¸ç„¶ä½ çš„ Web App åœ¨ Safari ä¸Šçš„é«”é©—æœƒè®Šå¾—å¾ˆå·®ï¼Œå› ç‚ºå¾ˆå¤šæ±è¥¿éƒ½ä¸æ”¯æ´ã€‚</p>
<p>è‡³æ–¼ Safari æœ€å¤§çš„ä¸€é»å•é¡Œæˆ‘ç›´æ¥å¼•ç”¨ä¸Šé¢ <a href="https://medium.com/@firt/pwas-are-coming-to-ios-11-3-cupertino-we-have-a-problem-2ff49fd7d6ea" target="_blank" rel="noopener">PWAs are coming to iOS 11.3: Cupertino, we have a problem</a> çš„å…¶ä¸­ä¸€æ®µï¼š</p>
<blockquote>
<p>Also, itâ€™s a massive problem for apps with two-factor authentication, such as Twitter. If you need to go to another app to get a token or to open a text message or an email, you will get out of the PWA. When you go back to paste the code, you are out of context and, you need to start the login process again losing the validity of that code. It happened to me on Twitter! Which means, the Twitter PWA on iOS is completely unusable for me.</p>
</blockquote>
<p>é€™æ˜¯ä»€éº¼æ„æ€å‘¢ï¼Ÿæˆ‘ç›´æ¥èˆ‰ä¸€å€‹å¯¦éš›ç¯„ä¾‹ï¼Œå‡å¦‚ä½ çš„ PWA æœ‰æä¾› Facebook ç™»å…¥çš„åŠŸèƒ½è€Œä¸”æ˜¯ç”¨é‡æ–°å°å‘çš„æ–¹å¼ï¼Œä½ ä¸€é»ä¸‹å»ä»–å°±æœƒé–‹ä¸€å€‹æ–°çš„ Safari è¦–çª—é€£åˆ° Facebook è®“ä½ æˆæ¬Šï¼Œå¯æ˜¯ç•¶ä½ æˆæ¬Šå®Œä¹‹å¾Œå›åˆ° PWAï¼Œä½ æœƒç™¼ç¾ä»€éº¼äº‹æƒ…éƒ½æ²’ç™¼ç”Ÿã€‚</p>
<p>é€™ä¸€é»çœŸçš„è¶…å‚·ï¼Œè€Œä¸”ç¾åœ¨æ‡‰è©²éƒ½é‚„æ²’ä¿®å¥½ï¼Œåªèƒ½æœŸå¾… Safari ä¹‹å¾ŒæœƒæŠŠå•é¡Œä¿®æ‰äº†ã€‚è€Œ Android Chrome å‰‡æ˜¯æœƒåœ¨åŒä¸€å€‹è¦–çª—åº•ä¸‹æ‰“é–‹ Facebookï¼Œå› æ­¤çµæŸä¹‹å¾Œèƒ½å¤ é †åˆ©å®Œæˆç™»å…¥æµç¨‹ã€‚</p>
<p>æœ‰é—œæ–¼ iOS çš„å•é¡Œè·Ÿ<code>manifest.json</code>çš„æ³¨æ„äº‹é …å·®ä¸å¤šå°±åˆ°é€™é‚Šï¼Œå†ä¾†æˆ‘å€‘è«‡è«‡ PWA çš„ç¬¬äºŒå€‹é‡é»ï¼šService Workerã€‚</p>
<h1><span id="service-worker">Service Worker</span></h1>
<p>åŠ å…¥ Service Worker çš„ç›®çš„å°±åªæœ‰ä¸€å€‹ï¼Œé‚£å°±æ˜¯å¿«å–ã€‚é€é Service Workerï¼ˆä»¥ä¸‹ç°¡ç¨± SWï¼‰ï¼Œå¯ä»¥å¹«åŠ©æˆ‘å€‘åœ¨ç™¼é€ request ä¹‹å‰å°±å…ˆæ””æˆªåˆ°ä¸¦ä¸”åšè™•ç†ï¼Œè€Œé›¢ç·šé‹è¡Œçš„åŸç†ä¹Ÿæ˜¯é€™æ¨£çš„ï¼Œæˆ‘å€‘å…ˆåœ¨ç¬¬ä¸€æ¬¡é–‹å•Ÿæ™‚è¨»å†Š SWï¼Œä¸¦ä¸”åˆ©ç”¨ SW ä¸‹è¼‰éœæ…‹æª”æ¡ˆä¸¦å¿«å–ä½ï¼Œä¹‹å¾Œè‹¥ä½¿ç”¨è€…é›¢ç·šï¼Œæˆ‘å€‘å†ç”¨å·²ç¶“å¿«å–ä½çš„æª”æ¡ˆä¾†å›è¦†ï¼Œå°±ä¸æœƒç™¼é€çœŸçš„ requestï¼Œè‡ªç„¶ä¹Ÿä¸æœƒç™¼ç”Ÿç„¡æ³•é€£ç·šçš„æƒ…æ³ã€‚</p>
<p>è€Œ Google æœ‰æä¾›äº†ä¸€å€‹æ–¹ä¾¿çš„å·¥å…·ï¼š<a href="https://developers.google.com/web/tools/workbox/" target="_blank" rel="noopener">Workbox</a> ä¾†å¹«åŠ©æˆ‘å€‘è‡ªå‹•ç”¢ç”Ÿå‡º SW ä»¥åŠåˆ©ç”¨æ›´æ–¹ä¾¿çš„èªæ³•ä¾†æ””æˆª requestã€‚</p>
<p>èˆ‰ä¾‹ä¾†èªªï¼Œæˆ‘è‡ªå·±ç”¨çš„æ˜¯ Webpack çš„ pluginï¼š</p>
<p><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">new</span> workboxPlugin.InjectManifest(&#123;</span><br><span class="line">    swSrc: path.join(__dirname, <span class="hljs-string">'..'</span>, SRC_DIR, <span class="hljs-string">'sw.js'</span>),</span><br><span class="line">    swDest: path.join(__dirname, <span class="hljs-string">'..'</span>, DIST_DIR, <span class="hljs-string">'sw.js'</span>),</span><br><span class="line">    globDirectory: path.join(__dirname, <span class="hljs-string">'..'</span>, DIST_DIR),</span><br><span class="line">    globPatterns: [<span class="hljs-string">'**/*.&#123;js,css&#125;'</span>]</span><br><span class="line">&#125;),</span><br><span class="line">  </span><br><span class="line"><span class="hljs-comment">//sw.js</span></span><br><span class="line"><span class="hljs-keyword">let</span> precacheList = self.__precacheManifest || []</span><br><span class="line">workbox.precaching.precacheAndRoute(precacheList)</span><br></pre></td></tr></table></figure></p>
<p>åªè¦é€™æ¨£ä¸€å¯«ï¼Œå°±æœƒè‡ªå‹•å»æ‰¾ç¬¦åˆè¦å‰‡çš„æª”æ¡ˆä¸¦ä¸”åŠ å…¥å¿«å–æ¸…å–®è£¡é¢ï¼Œä½ åªè¦ä¸€è¨»å†Š SW çš„æ™‚å€™å°±æœƒæŠŠé‚£äº›æª”æ¡ˆçµ¦å¿«å–èµ·ä¾†ã€‚</p>
<p>é™¤æ­¤ä¹‹å¤–å‘¢ï¼ŒWorkbox ä¹Ÿå¯ä»¥é‡å° URL ä¾†ç›£è½ï¼š</p>
<p><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// sw.js</span></span><br><span class="line">workbox.routing.registerRoute(<span class="hljs-regexp">/(https?:\/\/)(.*)\/api\/(.*)/</span>, args =&gt;</span><br><span class="line">    workbox.strategies</span><br><span class="line">        .networkFirst(&#123;</span><br><span class="line">            cacheName: <span class="hljs-string">'data-cache'</span>,</span><br><span class="line">            plugins: [</span><br><span class="line">                <span class="hljs-keyword">new</span> workbox.expiration.Plugin(&#123;</span><br><span class="line">                    maxEntries: <span class="hljs-number">100</span>,</span><br><span class="line">                    maxAgeSeconds: <span class="hljs-number">2592000</span></span><br><span class="line">                &#125;)</span><br><span class="line">            ]</span><br><span class="line">        &#125;)</span><br><span class="line">        .handle(args)</span><br><span class="line">        .then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="hljs-keyword">return</span> response</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'err:'</span>, err)</span><br><span class="line">        &#125;)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>åƒä¸Šé¢çš„ç¨‹å¼ç¢¼å°±æ˜¯é‡å°è·¯å¾‘ä¸­å«æœ‰<code>api</code>çš„ request åšå¿«å–ï¼Œé€™æ¨£åœ¨é›¢ç·šæ™‚ä¹Ÿå¯ä»¥åˆ©ç”¨ä»¥å‰å¿«å–ä½çš„ API responseã€‚</p>
<p>Workbox é‡å°é€™ç¨®å‹•æ…‹çš„å¿«å–æä¾›å¹¾ç¨®ç­–ç•¥ï¼Œåˆ†åˆ¥æ˜¯ï¼š<code>staleWhileRevalidate</code>ã€<code>cacheFirst</code>ã€<code>networkFirst</code>ã€<code>networkOnly</code>èˆ‡<code>cacheOnly</code>ï¼Œå…¶å¯¦çœ‹åå­—å°±å¯ä»¥å¤§æ¦‚ç†è§£ç­–ç•¥æ˜¯ä»€éº¼äº†ï¼Œæƒ³çŸ¥é“è©³ç´°çš„å…§å®¹å¯ä»¥åƒè€ƒå®˜æ–¹æ–‡ä»¶ï¼š<a href="https://developers.google.com/web/tools/workbox/modules/workbox-strategies" target="_blank" rel="noopener">Workbox Strategies</a>ã€‚</p>
<p>ç¸½ä¹‹è‡ªå¾æœ‰äº† Workbox ä¹‹å¾Œï¼ŒåŸºæœ¬ä¸Šå°±ä¸ç”¨è‡ªå·±æ‰‹å¯« SW äº†ï¼Œéƒ½é è‘—å®ƒæä¾›çš„ API ä»¥åŠåŠŸèƒ½å°±è¡Œäº†ï¼Œå°±å¯ä»¥è‡ªå‹•ç”¢ç”Ÿå‡ºç¬¦åˆéœ€æ±‚çš„ SWã€‚</p>
<h1><span id="add-to-home-screen-banner">Add to home screen banner</span></h1>
<p>æœ€å¾Œè¦ä¾†è«‡çš„æ˜¯ã€Œå®‰è£ PWAã€é€™ä¸€å¡Šï¼Œåœ¨ iOS Safari ä¸Šé¢åˆ¥ç„¡ä»–æ³•ï¼Œå°±åªèƒ½è‡ªå·±å«å‡ºé¸å–®ç„¶å¾Œé¸å–ã€ŒAdd to home screenã€ï¼Œå¯æ˜¯åœ¨ Android Chrome ä¸Šé¢ï¼Œå¦‚æœä½ ç¬¦åˆä¸€å®šçš„æ¢ä»¶ï¼ˆæœ‰è¨­ç½®<code>mainfest.json</code>ä»¥åŠæœ‰è¨»å†Š Service Workerï¼‰ï¼Œå°±æœƒè‡ªå‹•å¹«ä½ è·³å‡ºä¸€å€‹å¯æ„›çš„ Install bannerã€‚</p>
<p><img src="https://user-images.githubusercontent.com/2755720/49352007-d3c09e00-f6f0-11e8-8106-01335810b01a.png" alt="pwa"></p>
<p>ï¼ˆåœ–ç‰‡ä¾†è‡ªï¼š<a href="https://developers.google.com/web/updates/2018/06/a2hs-updates" target="_blank" rel="noopener">Changes to Add to Home Screen Behavior</a>ï¼‰</p>
<p>æ ¹æ“š Chrome ç‰ˆæœ¬çš„ä¸åŒï¼Œè¡Œç‚ºä¹Ÿæœ‰æ‰€ä¸åŒã€‚</p>
<p>åœ¨ Chrome 67ï¼ˆå«ï¼‰ä»¥å‰çš„ç‰ˆæœ¬ï¼Œå¦‚æœä½ åœ¨<code>beforeinstallprompt</code>äº‹ä»¶è£¡é¢æ²’æœ‰ç‰¹åˆ¥ç”¨<code>preventDefault()</code>ï¼Œæˆ–æ˜¯é¡¯å¼çš„å‘¼å«äº†<code>prompt()</code>ï¼Œå°±æœƒå‡ºç¾æœ€å·¦é‚Šé‚£å€‹é —å¤§çš„ A2HS bannerã€‚</p>
<p>ç„¶å¾Œåœ¨ Chrome 68ï¼ˆå«ï¼‰ä¹‹å¾Œçš„ç‰ˆæœ¬ï¼Œç„¡è«–ä½ åšäº†ä»€éº¼ï¼Œç³»çµ±éƒ½æœƒè‡ªå‹•å‡ºç¾é‚£å€‹ Mini-infobarï¼Œä½†å¦‚æœä½¿ç”¨è€…é—œæ‰çš„è©±ï¼Œè¦éš”ä¸‰å€‹æœˆæ‰æœƒå†å‡ºç¾ä¸€æ¬¡ï¼Œå¯¦åœ¨æ˜¯æœ‰å¤ ä¹…ã€‚</p>
<p>æ¥è‘—å‘¢ï¼Œä¸Šé¢é€™å…©å€‹ A2HS banner è·Ÿ Mini-infobarï¼Œä½¿ç”¨è€…é»æ“Šä¹‹å¾Œéƒ½æœƒå‡ºç¾æœ€å³é‚Šçš„ A2HS Dialogï¼Œæç¤ºä½¿ç”¨è€…è¦ä¸è¦å®‰è£ PWAã€‚</p>
<p>ä½†æ˜¯åœ¨ Chrome 68 ä»¥å¾Œï¼Œä½ ä¹Ÿå¯ä»¥åˆ©ç”¨ç¨‹å¼å»å‘¼å«<code>beforeinstallprompt</code>è£¡é¢æ‹¿åˆ°çš„<code>event.prompt()</code>æŠŠé€™å€‹ dialog é¡¯ç¤ºå‡ºä¾†ã€‚</p>
<p>è½èµ·ä¾†æœ‰é»è¤‡é›œå°å§ï¼Ÿ</p>
<p>å…ˆä¾†ä»‹ç´¹<code>beforeinstallprompt</code>é€™å€‹ event å¥½äº†ï¼Œé€™å€‹ event åœ¨ä¸€åˆ‡éƒ½æº–å‚™å°±ç·’ï¼Œç¢ºèªä½ æ»¿è¶³æ¢ä»¶å¯ä»¥é¡¯ç¤º prompt çš„æ™‚å€™æœƒè¢«è§¸ç™¼ï¼Œæœƒå‚³ä¾†ä¸€å€‹ eventï¼Œä½ å¯ä»¥é˜»æ­¢é¡¯ç¤º promptï¼ŒæŠŠé€™å€‹ event å­˜èµ·ä¾†ï¼š</p>
<p><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// æ­¤ç¯„ä¾‹ä¾†è‡ªä¸Šé¢çš„å®˜æ–¹æ–‡ä»¶</span></span><br><span class="line"><span class="hljs-keyword">let</span> installPromptEvent;</span><br><span class="line">  </span><br><span class="line"><span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">'beforeinstallprompt'</span>, (event) =&gt; &#123;</span><br><span class="line">  <span class="hljs-comment">// Prevent Chrome &lt;= 67 from automatically showing the prompt</span></span><br><span class="line">  event.preventDefault();</span><br><span class="line">  <span class="hljs-comment">// Stash the event so it can be triggered later.</span></span><br><span class="line">  installPromptEvent = event;</span><br><span class="line">  <span class="hljs-comment">// Update the install UI to notify the user app can be installed</span></span><br><span class="line">  <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'#install-button'</span>).disabled = <span class="hljs-literal">false</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>ç‚ºä»€éº¼è¦å­˜èµ·ä¾†å‘¢ï¼Ÿå› ç‚ºä½¿ç”¨è€…å¯èƒ½ä¸æƒ³ä¸€æ‰“é–‹ç¶²ç«™å°±çœ‹åˆ°é€™å€‹å½ˆçª—ï¼Œæˆ–è€…ä»–å¯èƒ½æ­£åœ¨çµå¸³çµæœä½ è·³é€™å€‹æ±è¥¿ä¾†å¹²æ“¾ä»–ï¼Œæ‰€ä»¥å…ˆæŠŠå®ƒå­˜èµ·ä¾†ï¼Œç­‰é©ç•¶çš„æ™‚æ©Ÿå†å‘¼å«<code>installPromptEvent.prompt()</code>ä¾†è·³å‡º Dialogã€‚</p>
<p>ä½†è¦æ³¨æ„çš„äº‹æƒ…æ˜¯ä½ ç›´æ¥å‘¼å«<code>installPromptEvent.prompt()</code>æ˜¯æ²’ç”¨çš„ï¼Œä½ å¿…é ˆè¦<code>within a user gesture</code>ï¼Œæ„æ€å°±æ˜¯ä½ è¦æ”¾åœ¨æŒ‰éˆ•çš„ click äº‹ä»¶ï¼ˆæˆ–å…¶ä»–ç”±ä½¿ç”¨è€…è§¸ç™¼çš„äº‹ä»¶ï¼‰è£¡æ‰æœ‰æ•ˆï¼Œç›´æ¥å‘¼å«æ˜¯æ²’æœ‰ç”¨çš„ï¼Œè€Œä¸”æœƒçœ‹åˆ° console è·³å‡ºéŒ¯èª¤è¨Šæ¯ã€‚</p>
<p>æˆ‘ä¹‹å‰ä¸€åº¦å¾ˆå¥½å¥‡å®ƒæ˜¯æ€éº¼åšåˆ¤æ–·çš„ï¼Œå¾Œä¾†ç™¼ç¾åŸä¾†æœ‰<code>event.isTrusted</code>å¯ä»¥ç”¨ï¼Œå¯ä»¥åˆ¤æ–·ä¸€å€‹äº‹ä»¶æ˜¯ä¸æ˜¯è¢«ä½¿ç”¨è€…ä¸»å‹•è§¸ç™¼çš„ï¼Œåƒè€ƒè³‡æ–™ï¼š<a href="https://developer.mozilla.org/en-US/docs/Web/API/Event/isTrusted" target="_blank" rel="noopener">MDN - Event.isTrusted</a>ã€‚</p>
<p>ç¸½ä¹‹å‘¢ï¼Œå› ç‚ºåœ¨ä¸åŒç‰ˆæœ¬ä¸Šçš„ Chrome æœ‰ä¸åŒè¡Œç‚ºï¼Œæ‰€ä»¥æœ€å¾Œæˆ‘å€‘æ±ºå®šç”¨ä¸‹é¢çš„ç¨‹å¼ç¢¼é‡å°ä¸åŒç‰ˆæœ¬æœ‰ä¸åŒçš„åæ‡‰ï¼š</p>
<p><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// æŠŠ event å­˜èµ·ä¾†</span></span><br><span class="line"><span class="hljs-keyword">var</span> installPromptEvent</span><br><span class="line">  </span><br><span class="line"><span class="hljs-comment">// è¦é¡¯ç¤º prompt çš„å»¶é²</span></span><br><span class="line"><span class="hljs-keyword">var</span> showTime = <span class="hljs-number">30</span> * <span class="hljs-number">1000</span></span><br><span class="line">  </span><br><span class="line"><span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">'beforeinstallprompt'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>&#123;</span><br><span class="line">  e.preventDefault()</span><br><span class="line">  installPromptEvent = e</span><br><span class="line">  <span class="hljs-keyword">var</span> data = navigator.userAgent.match(<span class="hljs-regexp">/Chrom(e|ium)\\/</span>([<span class="hljs-number">0</span><span class="hljs-number">-9</span>]+)\\./)</span><br><span class="line">  <span class="hljs-keyword">var</span> version = (data &amp;&amp; data.length &gt;= <span class="hljs-number">2</span>) ? <span class="hljs-built_in">parseInt</span>(data[<span class="hljs-number">2</span>], <span class="hljs-number">10</span>) : <span class="hljs-literal">null</span></span><br><span class="line">  <span class="hljs-keyword">if</span> (version &amp;&amp; installPromptEvent.prompt) &#123;</span><br><span class="line">  </span><br><span class="line">    <span class="hljs-comment">// å»¶é²ä¸€æ®µæ™‚é–“æ‰é¡¯ç¤º prompt</span></span><br><span class="line">    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">        <span class="hljs-comment">// å¦‚æœ Chrome ç‰ˆæœ¬æ˜¯ 67ï¼ˆå«ï¼‰ä»¥ä¸‹ï¼Œå¯ä»¥ç›´æ¥å‘¼å«</span></span><br><span class="line">        <span class="hljs-keyword">if</span> (version &lt;= <span class="hljs-number">67</span>) &#123;</span><br><span class="line">            installPromptEvent.prompt()</span><br><span class="line">            <span class="hljs-keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">  </span><br><span class="line">        <span class="hljs-comment">// å¦å‰‡çš„è©±å¿…é ˆé€é user action ä¸»å‹•è§¸ç™¼</span></span><br><span class="line">        <span class="hljs-comment">// é€™é‚Šå¹« #root åŠ ä¸Š event listenerï¼Œä»£è¡¨é»æ“Šè¢å¹•ä»»ä½•ä¸€è™•éƒ½æœƒé¡¯ç¤º prompt</span></span><br><span class="line">        <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'#root'</span>).addEventListener(<span class="hljs-string">'click'</span>, addToHomeScreen)    </span><br><span class="line">    &#125;, showTime)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">  </span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addToHomeScreen</span>(<span class="hljs-params">e</span>) </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (installPromptEvent) &#123;</span><br><span class="line">        installPromptEvent.prompt()</span><br><span class="line">        installPromptEvent = <span class="hljs-literal">null</span></span><br><span class="line">        <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'#root'</span>).removeEventListener(<span class="hljs-string">'click'</span>, addToHomeScreen) </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å¦‚æœæ˜¯ 67 ä»¥ä¸‹ï¼Œç›´æ¥å‘¼å«å°±å¯ä»¥é¡¯ç¤º promptï¼Œå¦å‰‡çš„è©±é‚„è¦å†ä¸€æ­¥ï¼Œè¦åŠ å€‹ event listener æ‰è¡Œï¼Œè€Œæˆ‘å€‘ä¹Ÿé¸æ“‡å»¶é² 30 ç§’æ‰é¡¯ç¤ºã€‚</p>
<p>å‡ºä¹æ„æ–™åœ°ï¼Œé€™æ¨£ä¸€å€‹å°æ”¹å‹•å¸¶ä¾†é©šäººçš„æˆé•·ï¼ŒåŸæœ¬ä¸€å¤©å¤§æ¦‚æ‰ 20ã€30 å€‹äººå®‰è£ PWAï¼Œç¶“éé€™æ¨£èª¿æ•´ä¹‹å¾Œç¬é–“è®Šæˆå…«åˆ°åå€ï¼Œçœ‹åˆ° GA çš„é‚£å€‹çµ±è¨ˆåœ–æˆ‘ä¹Ÿåš‡äº†ä¸€è·³ï¼Œæ²’æƒ³åˆ°æ•ˆæœé€™éº¼å¥½ã€‚</p>
<p>èˆ‡å…¶ä¸€ç›´ç©æ¥µåœ°è¦åˆ¥äººå¿«é»å®‰è£ PWAï¼Œé‚„ä¸å¦‚åªè¦æ±‚çœŸçš„å°ä½ ç”¢å“æœ‰èˆˆè¶£ï¼ˆåœç•™è¶…é 30 ç§’é˜ï¼‰çš„äººã€‚</p>
<h1><span id="manifest-è§€æ‘©">manifest è§€æ‘©</span></h1>
<p>æœ€å¾Œæˆ‘å€‘ä¾†çœ‹çœ‹å¹¾å€‹çŸ¥åçš„ PWA éƒ½æ˜¯æ€éº¼å¯«ä»–å€‘çš„<code>manifest.json</code>ã€‚</p>
<p>ç¬¬ä¸€å€‹æ˜¯ PWA ç•Œä¸­å¾ˆæœ‰åçš„ <a href="https://www.flipkart.com/" target="_blank" rel="noopener">flipkart</a>ï¼š</p>
<p><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="hljs-string">"name"</span>: <span class="hljs-string">"Flipkart Lite"</span>,</span><br><span class="line">    <span class="hljs-string">"short_name"</span>: <span class="hljs-string">"Flipkart Lite"</span>,</span><br><span class="line">    <span class="hljs-string">"icons"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="hljs-string">"src"</span>: <span class="hljs-string">"https://img1a.flixcart.com/www/linchpin/batman-returns/logo_lite-cbb3574d.png"</span>,</span><br><span class="line">            <span class="hljs-string">"sizes"</span>: <span class="hljs-string">"192x192"</span>,</span><br><span class="line">            <span class="hljs-string">"type"</span>: <span class="hljs-string">"image/png"</span></span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="hljs-string">"gcm_sender_id"</span>: <span class="hljs-string">"656085505957"</span>,</span><br><span class="line">    <span class="hljs-string">"gcm_user_visible_only"</span>: <span class="hljs-literal">true</span>,</span><br><span class="line">    <span class="hljs-string">"start_url"</span>: <span class="hljs-string">"/?start_url=homescreenicon"</span>,</span><br><span class="line">    <span class="hljs-string">"permissions"</span>: [</span><br><span class="line">        <span class="hljs-string">"gcm"</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="hljs-string">"orientation"</span>: <span class="hljs-string">"portrait"</span>,</span><br><span class="line">    <span class="hljs-string">"display"</span>: <span class="hljs-string">"standalone"</span>,</span><br><span class="line">    <span class="hljs-string">"theme_color"</span>: <span class="hljs-string">"#2874f0"</span>,</span><br><span class="line">    <span class="hljs-string">"background_color"</span>: <span class="hljs-string">"#2874f0"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å†ä¾†æ˜¯é¼é¼å¤§åçš„ <a href="https://mobile.twitter.com/manifest.json" target="_blank" rel="noopener">twitter</a>ï¼š</p>
<p><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="hljs-string">"background_color"</span>: <span class="hljs-string">"#ffffff"</span>,</span><br><span class="line">  <span class="hljs-string">"description"</span>: <span class="hljs-string">"It's what's happening. From breaking news and entertainment, sports and politics, to big events and everyday interests."</span>,</span><br><span class="line">  <span class="hljs-string">"display"</span>: <span class="hljs-string">"standalone"</span>,</span><br><span class="line">  <span class="hljs-string">"gcm_sender_id"</span>: <span class="hljs-string">"49625052041"</span>,</span><br><span class="line">  <span class="hljs-string">"gcm_user_visible_only"</span>: <span class="hljs-literal">true</span>,</span><br><span class="line">  <span class="hljs-string">"icons"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="hljs-string">"src"</span>: <span class="hljs-string">"https://abs.twimg.com/responsive-web/web/ltr/icon-default.604e2486a34a2f6e.png"</span>,</span><br><span class="line">      <span class="hljs-string">"sizes"</span>: <span class="hljs-string">"192x192"</span>,</span><br><span class="line">      <span class="hljs-string">"type"</span>: <span class="hljs-string">"image/png"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="hljs-string">"src"</span>: <span class="hljs-string">"https://abs.twimg.com/responsive-web/web/ltr/icon-default.604e2486a34a2f6e.png"</span>,</span><br><span class="line">      <span class="hljs-string">"sizes"</span>: <span class="hljs-string">"512x512"</span>,</span><br><span class="line">      <span class="hljs-string">"type"</span>: <span class="hljs-string">"image/png"</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="hljs-string">"name"</span>: <span class="hljs-string">"Twitter"</span>,</span><br><span class="line">  <span class="hljs-string">"share_target"</span>: &#123;</span><br><span class="line">    <span class="hljs-string">"action"</span>: <span class="hljs-string">"compose/tweet"</span>,</span><br><span class="line">    <span class="hljs-string">"params"</span>: &#123;</span><br><span class="line">      <span class="hljs-string">"title"</span>: <span class="hljs-string">"title"</span>,</span><br><span class="line">      <span class="hljs-string">"text"</span>: <span class="hljs-string">"text"</span>,</span><br><span class="line">      <span class="hljs-string">"url"</span>: <span class="hljs-string">"url"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="hljs-string">"short_name"</span>: <span class="hljs-string">"Twitter"</span>,</span><br><span class="line">  <span class="hljs-string">"start_url"</span>: <span class="hljs-string">"/"</span>,</span><br><span class="line">  <span class="hljs-string">"theme_color"</span>: <span class="hljs-string">"#ffffff"</span>,</span><br><span class="line">  <span class="hljs-string">"scope"</span>: <span class="hljs-string">"/"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>æœ€å¾Œå‰‡æ˜¯ <a href="https://events.google.com/io" target="_blank" rel="noopener">Google I/O 2018</a>ï¼š</p>
<p><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="hljs-string">"name"</span>: <span class="hljs-string">"Google I/O 2018"</span>,</span><br><span class="line">  <span class="hljs-string">"short_name"</span>: <span class="hljs-string">"I/O 2018"</span>,</span><br><span class="line">  <span class="hljs-string">"start_url"</span>: <span class="hljs-string">"./?utm_source=web_app_manifest"</span>,</span><br><span class="line">  <span class="hljs-string">"display"</span>: <span class="hljs-string">"standalone"</span>,</span><br><span class="line">  <span class="hljs-string">"theme_color"</span>: <span class="hljs-string">"#6284F3"</span>,</span><br><span class="line">  <span class="hljs-string">"background_color"</span>: <span class="hljs-string">"#6284F3"</span>,</span><br><span class="line">  <span class="hljs-string">"icons"</span>: [&#123;</span><br><span class="line">    <span class="hljs-string">"src"</span>: <span class="hljs-string">"static/images/homescreen/homescreen57.png"</span>,</span><br><span class="line">    <span class="hljs-string">"sizes"</span>: <span class="hljs-string">"57x57"</span>,</span><br><span class="line">    <span class="hljs-string">"type"</span>: <span class="hljs-string">"image/png"</span></span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    <span class="hljs-string">"src"</span>: <span class="hljs-string">"static/images/homescreen/homescreen114.png"</span>,</span><br><span class="line">    <span class="hljs-string">"sizes"</span>: <span class="hljs-string">"114x114"</span>,</span><br><span class="line">    <span class="hljs-string">"type"</span>: <span class="hljs-string">"image/png"</span></span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    <span class="hljs-string">"src"</span>: <span class="hljs-string">"static/images/homescreen/homescreen128.png"</span>,</span><br><span class="line">    <span class="hljs-string">"sizes"</span>: <span class="hljs-string">"128x128"</span>,</span><br><span class="line">    <span class="hljs-string">"type"</span>: <span class="hljs-string">"image/png"</span></span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    <span class="hljs-string">"src"</span>: <span class="hljs-string">"static/images/homescreen/homescreen144.png"</span>,</span><br><span class="line">    <span class="hljs-string">"sizes"</span>: <span class="hljs-string">"144x144"</span>,</span><br><span class="line">    <span class="hljs-string">"type"</span>: <span class="hljs-string">"image/png"</span></span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    <span class="hljs-string">"src"</span>: <span class="hljs-string">"static/images/homescreen/homescreen192.png"</span>,</span><br><span class="line">    <span class="hljs-string">"sizes"</span>: <span class="hljs-string">"192x192"</span>,</span><br><span class="line">    <span class="hljs-string">"type"</span>: <span class="hljs-string">"image/png"</span></span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    <span class="hljs-string">"src"</span>: <span class="hljs-string">"static/images/homescreen/homescreen512.png"</span>,</span><br><span class="line">    <span class="hljs-string">"sizes"</span>: <span class="hljs-string">"512x512"</span>,</span><br><span class="line">    <span class="hljs-string">"type"</span>: <span class="hljs-string">"image/png"</span></span><br><span class="line">  &#125;],</span><br><span class="line">  <span class="hljs-string">"prefer_related_applications"</span>: <span class="hljs-literal">false</span>,</span><br><span class="line">  <span class="hljs-string">"related_applications"</span>: [&#123;</span><br><span class="line">    <span class="hljs-string">"platform"</span>: <span class="hljs-string">"play"</span>,</span><br><span class="line">    <span class="hljs-string">"id"</span>: <span class="hljs-string">"com.google.samples.apps.iosched"</span></span><br><span class="line">  &#125;],</span><br><span class="line">  <span class="hljs-string">"gcm_sender_id"</span>: <span class="hljs-string">"103953800507"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>æˆ‘æ»¿å–œæ­¡è§€å¯Ÿåˆ¥äººå®¶çš„é€™äº›æ±è¥¿ï¼Œå› ç‚ºä½ æœƒç™¼ç¾å¾ˆå¤šä½ æŸ¥è³‡æ–™æ™‚éºæ¼æˆ–æ˜¯æ ¹æœ¬æ‰¾ä¸åˆ°çš„è³‡è¨Šï¼Œè€Œä¸”é€™äº›çœ‹ä¹…äº†ä½ ä¹Ÿæœƒæœ‰å€‹æ¦‚å¿µï¼ŒçŸ¥é“å“ªäº›å±¬æ€§ç‰¹åˆ¥å¸¸ç”¨ï¼Œé™¤äº†<code>manifest.json</code>ä»¥å¤–ï¼Œä¹Ÿå¯ä»¥åƒè€ƒ html è£¡é¢çš„ tagï¼Œä¸€æ¨£èƒ½å­¸ç¿’åˆ°å¾ˆå¤šã€‚</p>
<h1><span id="çµè«–">çµè«–</span></h1>
<p>å‰é™£å­åœ¨èˆ‡ PWA å¥®æˆ°ä»¥åŠè¢« PM çš„å¤¾æ“Šä¹‹ä¸‹ï¼Œæœé›†äº†å¾ˆå¤šè·Ÿ PWA æœ‰é—œçš„è³‡æ–™ï¼Œä¹Ÿåƒè€ƒäº†è¨±å¤šå¾ˆæœ‰ç”¨çš„æ–‡ç« ï¼ŒçœŸå¿ƒæ„Ÿè¬é‚£äº›å‰è¼©å€‘çš„åˆ†äº«ï¼Œæ‰èƒ½é¿å…å¾Œäººè¸©ä¸€å¤§å †å‘ã€‚</p>
<p>é›–ç„¶åœ¨ iOS ä¸Šçš„é«”é©—å·®äº†é»ï¼Œä½†æ•´é«”ä¾†èªªæˆ‘é‚„æ˜¯å¾ˆçœ‹å¥½ PWA çš„ç™¼å±•ï¼Œç¬¬ä¸€å€‹æ˜¯ Google å¼·åŠ›æ¨å‹•ï¼Œç¬¬äºŒå€‹æ˜¯ç€è¦½å™¨çš„æ”¯æ´åº¦æ„ˆä¾†æ„ˆé«˜ï¼Œå°±åƒæˆ‘ä¸Šé¢èªªçš„ï¼ŒiOS Safari å·²ç¶“æœ‰æ…¢æ…¢æŠŠ Bug çµ¦ä¿®æ‰äº†ï¼Œä¹‹å¾Œçš„åŠŸèƒ½æœƒæ¯”è¼ƒå®Œæ•´ä¸€äº›ã€‚</p>
<p>å†è€…ï¼ŒPWA çš„ä½¿ç”¨è€…é«”é©—æ˜¯å¾ˆä¸éŒ¯çš„ï¼Œæœ‰å¯ä»¥æ¥å—çš„é€Ÿåº¦ä»¥åŠ Web çš„å½ˆæ€§ï¼Œé‡é»æ˜¯ä¸ç”¨å» Google Play ç‰¹åœ°ä¸‹è¼‰å°±å°‘äº†ä¸€é“è½‰æ›çš„é–€æª»ï¼ˆé›–ç„¶é‚„æ˜¯æœ‰å®‰è£ PWA çš„é–€æª»å°±æ˜¯äº†ï¼Œä½†æˆ‘è¦ºå¾—æ¯”è¼ƒå®¹æ˜“ä¸€äº›ï¼‰ï¼Œè€Œ Chrome ä¹Ÿæä¾›äº†è¨±å¤šæ©Ÿåˆ¶çµ¦ PWAï¼Œå¸Œæœ›ä½¿ç”¨è€…èƒ½å®‰è£ PWA åœ¨æ‰‹æ©Ÿä¸Šã€‚</p>
<p>ç¸½ä¹‹å‘¢ï¼Œé€™ç¯‡ä¸»è¦æ˜¯è·Ÿå¤§å®¶åˆ†äº«æˆ‘åœ¨åš PWA æ™‚å€™çš„ä¸€äº›å°å°å¿ƒå¾—ï¼Œå¦‚æœä½ ä¹Ÿæœ‰ä»€éº¼å¿ƒå¾—æ­¡è¿åœ¨åº•ä¸‹ç•™è¨€è·Ÿæˆ‘åˆ†äº«ï¼Œæ„Ÿè¬ã€‚</p>
<p>å»¶ä¼¸é–±è®€èˆ‡åƒè€ƒè³‡æ–™ï¼š</p>
<ol>
<li><a href="https://developers.google.com/web/updates/2018/06/a2hs-updates" target="_blank" rel="noopener">Changes to Add to Home Screen Behavior</a></li>
<li><a href="https://medium.com/@applification/progressive-web-app-splash-screens-80340b45d210" target="_blank" rel="noopener">Progressive Web App Splash Screens</a></li>
<li><a href="https://www.netguru.co/codestories/few-tips-that-will-make-your-pwa-on-ios-feel-like-native" target="_blank" rel="noopener">Few Tips That Will Make Your PWA on iOS Feel Like Native</a></li>
<li><a href="https://medium.com/@firt/pwas-are-coming-to-ios-11-3-cupertino-we-have-a-problem-2ff49fd7d6ea" target="_blank" rel="noopener">PWAs are coming to iOS 11.3: Cupertino, we have a problem</a></li>
<li><a href="https://blog.techbridge.cc/2016/07/23/progressive-web-app/" target="_blank" rel="noopener">Progressive Web App æœƒæ˜¯æœªä¾†è¶¨å‹¢å—ï¼Ÿ</a></li>
<li><a href="https://developers.google.com/web/showcase/" target="_blank" rel="noopener">PWA case studies</a></li>
<li><a href="https://medium.com/dev-channel/a-pinterest-progressive-web-app-performance-case-study-3bd6ed2e6154" target="_blank" rel="noopener">A Pinterest Progressive Web App Performance Case Study</a></li>
</ol>

    
    </div>
    
    <div class="columns is-variable is-1 is-multiline is-mobile">
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/Front-end/">#Front-end</a></span>
    
    </div>
    
    
    <div class="columns is-mobile is-multiline article-nav">
        <span class="column is-12-mobile is-half-desktop  article-nav-prev">
            
            <a href="/2018/11/10/javascript-hoisting-and-tdz/">æˆ‘çŸ¥é“ä½ æ‡‚ hoistingï¼Œå¯æ˜¯ä½ äº†è§£åˆ°å¤šæ·±ï¼Ÿ</a>
            
        </span>
        <span class="column is-12-mobile is-half-desktop  article-nav-next">
            
            <a href="/2018/09/14/aws-lambda-and-github-api/">AWS Lambda + GitHub API + Google Sheet = è‡ªå‹•åŒ–ç°½åˆ°ç³»çµ±</a>
            
        </span>
    </div>
    
</article>


<div class="sharebox">
    
<div class="sharethis-inline-share-buttons"></div>
<script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5d8b39b069ba670012bf92b9&amp;product=inline-share-buttons" async="async"></script>

</div>



<div class="comments">
    <h3 class="title is-4">è©•è«–</h3>
    
<script>
    var disqus_config = function () {
        this.page.url = 'https://blog.huli.tw/2018/10/13/pwa-in-action/';
        this.page.identifier = '2018/10/13/pwa-in-action/';
        
        this.language = 'en';
        
    };
    (function() {
        var d = document, s = d.createElement('script');  
        s.src = '//' + 'huli' + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>

<div id="disqus_thread">
    
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</div>

    </div>
</section>
    <footer class="footer">
    <div class="container">
        <div class="columns content">
            <div class="column is-narrow has-text-centered">
                &copy; 2019 Huli&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a href="http://github.com/ppoffice/hexo-theme-minos">Minos</a>
            </div>
            <div class="column is-hidden-mobile"></div>

            
            <div class="column is-narrow">
                <div class="columns is-mobile is-multiline is-centered">
                
                    
                <a class="column is-narrow has-text-black" title="GitHub" href="https://github.com/ppoffice/hexo-theme-minos">
                    
                    GitHub
                    
                </a>
                
                </div>
            </div>
            
            
        </div>
    </div>
</footer>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script>

<!-- test if the browser is outdated -->
<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.js"></script>
<script>
    $(document).ready(function () {
        // plugin function, place inside DOM ready function
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        })
    });
</script>

<script>
    window.FontAwesomeConfig = {
        searchPseudoElements: true
    }
    moment.locale("zh-tw");
</script>


    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script>
    MathJax.Hub.Config({
        "HTML-CSS": {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
</script>

    
    
    
    
<script src="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/js/lightgallery-all.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/js/jquery.justifiedGallery.min.js"></script>
<script>
    (function ($) {
        $(document).ready(function () {
            if (typeof($.fn.lightGallery) === 'function') {
                $('.article.gallery').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof($.fn.justifiedGallery) === 'function') {
                $('.justified-gallery').justifiedGallery();
            }
        });
    })(jQuery);
</script>

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <style>
        .hljs {
            position: relative;
        }

        .hljs .clipboard-btn {
            float: right;
            color: #9a9a9a;
            background: none;
            border: none;
            cursor: pointer;
        }

        .hljs .clipboard-btn:hover {
          color: #8a8a8a;
        }

        .hljs > .clipboard-btn {
            display: none;
            position: absolute;
            right: 4px;
            top: 4px;
        }

        .hljs:hover > .clipboard-btn {
            display: inline;
        }

        .hljs > figcaption > .clipboard-btn {
            margin-right: 4px;
        }
    </style>
    <script>
      $(document).ready(function () {
        $('figure.hljs').each(function(i, figure) {
          var codeId = 'code-' + i;
          var code = figure.querySelector('.code');
          var copyButton = $('<button>Copy <i class="far fa-clipboard"></i></button>');
          code.id = codeId;
          copyButton.addClass('clipboard-btn');
          copyButton.attr('data-clipboard-target-id', codeId);

          var figcaption = figure.querySelector('figcaption');

          if (figcaption) {
            figcaption.append(copyButton[0]);
          } else {
            figure.prepend(copyButton[0]);
          }
        })

        var clipboard = new ClipboardJS('.clipboard-btn', {
          target: function(trigger) {
            return document.getElementById(trigger.getAttribute('data-clipboard-target-id'));
          }
        });
        clipboard.on('success', function(e) {
          e.clearSelection();
        })
      })
    </script>

    
    

    


<script src="/js/script.js"></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-mask"></div>
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="ç«™å…§æœå°‹">
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'æ–‡ç« ',
                PAGES: 'é é¢',
                CATEGORIES: 'åˆ†é¡',
                TAGS: 'æ¨™ç±¤',
                UNTITLED: '(ç„¡æ¨™é¡Œ)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js"></script>
    
</body>
</html>